schema: '2.0'
stages:
  extract_dataset:
    cmd: python3 src/data/extract_dataset.py
    deps:
    - path: data/raw/zipped
      hash: md5
      md5: 2ac9e57fc0bc2d2a1a610a695529d479.dir
      size: 87295035
      nfiles: 2
    - path: src/data/extract_dataset.py
      hash: md5
      md5: 8bdfb87336145fa6651d8ffa1caebcdc
      size: 1643
    outs:
    - path: data/raw/extracted
      hash: md5
      md5: 07dcb976ec534725901d50758a399273.dir
      size: 271383386
      nfiles: 2

  make_dataset:
    cmd: python3 src/data/make_dataset.py train.csv
    deps:
    - path: data/raw/extracted/train.csv
      hash: md5
      md5: e59c291a4b1c640f1dab33b89daa22e1
      size: 200589097
    - path: src/data/make_dataset.py
      hash: md5
      md5: 222bdf465a0a5d54a02e7401e80a8cc8
      size: 3647
    params:
      params.yaml:
        make_dataset.random_state: 30
        make_dataset.test_size: 0.1
    outs:
    - path: data/interim
      hash: md5
      md5: baef4c9c571b9ebc89d5f8ecefdd20b1.dir
      size: 195546158
      nfiles: 2
  modify_features:
    cmd: python3 src/features/modify_features.py data/interim/val.csv data/interim/train.csv
      data/raw/extracted/test.csv
    deps:
    - path: data/interim/train.csv
      hash: md5
      md5: fbc0c04f9785c21d960f3998a413b8f1
      size: 175992018
    - path: data/interim/val.csv
      hash: md5
      md5: a69a0adfa27b23b7bf595f8372631e20
      size: 19554140
    - path: data/raw/extracted/test.csv
      hash: md5
      md5: 0686e4fc98617485dba9fdbabbf1c48d
      size: 70794289
    - path: src/features/modify_features.py
      hash: md5
      md5: cf6215596fe171559c19c365ef8dc8ea
      size: 8184
    outs:
    - path: data/processed/transformations
      hash: md5
      md5: f01d0f1fccb6f5d08f61465396210074.dir
      size: 206111649
      nfiles: 3
  build_features:
    cmd: python3 src/features/build_features.py data/processed/transformations/train.csv
      data/processed/transformations/test.csv data/processed/transformations/val.csv
    deps:
    - path: data/processed/transformations/test.csv
      hash: md5
      md5: a10d20d03f7e9ea04830a708b0e73a22
      size: 55769354
    - path: data/processed/transformations/train.csv
      hash: md5
      md5: ef750c01377b9fd811031c84e6ba36f4
      size: 135304049
    - path: data/processed/transformations/val.csv
      hash: md5
      md5: cf7cff0375f6e2735ba72519c643c0f2
      size: 15038246
    - path: src/features/build_features.py
      hash: md5
      md5: a6559b5359d14048b0c22110c35d1641
      size: 2244
    outs:
    - path: data/processed/build_features
      hash: md5
      md5: d60b79a9b4d50f53c25ffa0d20b0c918.dir
      size: 329165334
      nfiles: 3
  data_preprocessing:
    cmd: python3 src/features/data_preprocessing.py train.csv val.csv test.csv
    deps:
    - path: data/processed/build_features/test.csv
      hash: md5
      md5: 3d0c8c152d7cf56731ceecdd35250765
      size: 92720352
    - path: data/processed/build_features/train.csv
      hash: md5
      md5: f383793216a36bfa22f577ae1c0da3ab
      size: 212795333
    - path: data/processed/build_features/val.csv
      hash: md5
      md5: e58743d7cd699566b0b74b7aac405095
      size: 23649649
    - path: src/features/data_preprocessing.py
      hash: md5
      md5: 7dea8c507d0da6532f6f252573d190b4
      size: 6130
    params:
      params.yaml:
        data_preprocessing.percentiles:
        - 0.002
        - 0.998
    outs:
    - path: data/processed/final
      hash: md5
      md5: a4df4b3af7128e8ccadb8df1b81acfb7.dir
      size: 349518656
      nfiles: 3
    - path: models/transformers
      hash: md5
      md5: 13c0f27c5d2015179bb57e147124f879.dir
      size: 6565
      nfiles: 3
  train_model:
    cmd: python3 src/models/train_model.py data/processed/final/train.csv
    deps:
    - path: data/processed/final/train.csv
      hash: md5
      md5: a3bef2924e7c1cc30308daa8e64df416
      size: 15529323
    - path: src/models/train_model.py
      hash: md5
      md5: 5e8121695766ab60a6e7512fa3446d36
      size: 1963
    params:
      params.yaml:
        train_model.random_forest_regressor.max_depth: 6
        train_model.random_forest_regressor.n_estimator: 50
        train_model.random_forest_regressor.n_jobs: -1
        train_model.random_forest_regressor.verbose: 2
    outs:
    - path: models/models
      hash: md5
      md5: 8196a1fce0a6cba286bc21d1cf3e6eef.dir
      size: 465937
      nfiles: 1
  model_prediction:
    cmd: python3 src/models/predict_model.py train.csv val.csv
    deps:
    - path: data/processed/final/val.csv
      hash: md5
      md5: d2b124fcd1bc3824cc5b859c2a5299a0
      size: 25319303
    - path: models/models
      hash: md5
      md5: 0f795bcd79f77bfc03382cca2b475b51.dir
      size: 48838369
      nfiles: 1
    - path: src/models/predict_model.py
      hash: md5
      md5: 20baab08274329e2abb9dab388671ae4
      size: 1452
  model_train:
    cmd: python3 src/models/train_model.py data/processed/final/train.csv
    deps:
    - path: data/processed/final/train.csv
      hash: md5
      md5: ad8384fb1112e2e0cd06d9a3592ce625
      size: 227827187
    - path: src/models/train_model.py
      hash: md5
      md5: dc76c26979879f90829ab83c101c966b
      size: 2508
    params:
      params.yaml:
        train_model.xgboost_regressor.alpha: 0.8638051763524134
        train_model.xgboost_regressor.colsample_bytree: 0.6851584895794796
        train_model.xgboost_regressor.lambda: 0.2980553084358624
        train_model.xgboost_regressor.learning_rate: 0.09039281171805601
        train_model.xgboost_regressor.max_depth: 15
        train_model.xgboost_regressor.min_child_weight: 61
        train_model.xgboost_regressor.n_estimators: 249
        train_model.xgboost_regressor.subsample: 0.9485018772438987
    outs:
    - path: models/models
      hash: md5
      md5: 0f795bcd79f77bfc03382cca2b475b51.dir
      size: 48838369
      nfiles: 1
  plot_of_result:
    cmd: python3 src/visualization/plot_result.py train.csv val.csv
    deps:
    - path: data/processed/final/train.csv
      hash: md5
      md5: ad8384fb1112e2e0cd06d9a3592ce625
      size: 227827187
    - path: data/processed/final/val.csv
      hash: md5
      md5: d2b124fcd1bc3824cc5b859c2a5299a0
      size: 25319303
    - path: models/models
      hash: md5
      md5: 0f795bcd79f77bfc03382cca2b475b51.dir
      size: 48838369
      nfiles: 1
    - path: src/visualization/plot_result.py
      hash: md5
      md5: 5d2ba49474a1e0491a92b7379e88a69f
      size: 2050
    outs:
    - path: plots/model_results
      hash: md5
      md5: e9bbf50aff509905023341ea1c09837d.dir
      size: 18878
      nfiles: 1
